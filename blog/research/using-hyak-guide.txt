3:I[5613,[],""]
5:I[1778,[],""]
6:I[8029,["250","static/chunks/250-29b8274b9df70a43.js","830","static/chunks/830-6e2c732e83e0aeb6.js","185","static/chunks/app/layout-80592403bcf9e221.js"],"ThemeProviders"]
7:I[8625,["250","static/chunks/250-29b8274b9df70a43.js","830","static/chunks/830-6e2c732e83e0aeb6.js","185","static/chunks/app/layout-80592403bcf9e221.js"],"KBarSearchProvider"]
8:I[5250,["250","static/chunks/250-29b8274b9df70a43.js","749","static/chunks/749-e60b3fc40fd6d6ff.js","797","static/chunks/app/blog/%5B...slug%5D/page-85ddb9cf35024602.js"],""]
9:I[8271,["250","static/chunks/250-29b8274b9df70a43.js","830","static/chunks/830-6e2c732e83e0aeb6.js","185","static/chunks/app/layout-80592403bcf9e221.js"],"KBarButton"]
a:I[5021,["250","static/chunks/250-29b8274b9df70a43.js","830","static/chunks/830-6e2c732e83e0aeb6.js","185","static/chunks/app/layout-80592403bcf9e221.js"],""]
b:I[6422,["250","static/chunks/250-29b8274b9df70a43.js","830","static/chunks/830-6e2c732e83e0aeb6.js","185","static/chunks/app/layout-80592403bcf9e221.js"],""]
4:["slug","research/using-hyak-guide","c"]
0:["WD9-RjTuCcT2hzjqOcC3L",[[["",{"children":["blog",{"children":[["slug","research/using-hyak-guide","c"],{"children":["__PAGE__?{\"slug\":[\"research\",\"using-hyak-guide\"]}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":[["slug","research/using-hyak-guide","c"],{"children":["__PAGE__",{},["$L1","$L2",null]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$4","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":[["$","link","0",{"rel":"stylesheet","href":"/blog/_next/static/css/fd9df888cca87956.css","precedence":"next","crossOrigin":""}]]}]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},[null,["$","html",null,{"lang":"en-us","className":"__variable_fd2bdf scroll-smooth","suppressHydrationWarning":true,"children":[["$","link",null,{"rel":"apple-touch-icon","sizes":"76x76","href":"/static/favicons/apple-touch-icon.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"32x32","href":"/static/favicons/favicon-32x32.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"16x16","href":"/static/favicons/favicon-16x16.png"}],["$","link",null,{"rel":"manifest","href":"/static/favicons/site.webmanifest"}],["$","link",null,{"rel":"mask-icon","href":"/static/favicons/safari-pinned-tab.svg","color":"#5bbad5"}],["$","meta",null,{"name":"msapplication-TileColor","content":"#000000"}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: light)","content":"#fff"}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: dark)","content":"#000"}],["$","link",null,{"rel":"alternate","type":"application/rss+xml","href":"/feed.xml"}],["$","body",null,{"className":"bg-white text-black antialiased dark:bg-gray-950 dark:text-white","children":["$","$L6",null,{"children":[["$undefined","$undefined","$undefined","$undefined","$undefined"],["$","section",null,{"className":"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0","children":["$","div",null,{"className":"flex h-screen flex-col justify-between font-sans","children":[["$","$L7",null,{"kbarConfig":{"searchDocumentsPath":"search.json"},"children":[["$","header",null,{"className":"flex items-center justify-between py-10","children":[["$","div",null,{"children":["$","$L8",null,{"href":"/","aria-label":"AlexeysBlog","children":["$","div",null,{"className":"flex items-center justify-between","children":["$","div",null,{"className":"hidden h-6 text-2xl font-semibold sm:block","children":"AlexeysBlog"}]}]}]}],["$","div",null,{"className":"flex items-center space-x-4 leading-5 sm:space-x-6","children":[[["$","$L8",null,{"href":"/blog","className":"hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"Blog"}],["$","$L8",null,{"href":"/tags","className":"hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"Tags"}],["$","$L8",null,{"href":"/about","className":"hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"About"}]],["$","$L9",null,{"aria-label":"Search","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","className":"h-6 w-6 text-gray-900 dark:text-gray-100","children":["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}]}]}],["$","$La",null,{}],["$","$Lb",null,{}]]}]]}],["$","main",null,{"className":"mb-auto","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"className":"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6","children":[["$","div",null,{"className":"space-x-2 pb-8 pt-6 md:space-y-5","children":["$","h1",null,{"className":"text-6xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 md:border-r-2 md:px-6 md:text-8xl md:leading-14","children":"404"}]}],["$","div",null,{"className":"max-w-md","children":[["$","p",null,{"className":"mb-4 text-xl font-bold leading-normal md:text-2xl","children":"Sorry we couldn't find this page."}],["$","p",null,{"className":"mb-8","children":"But dont worry, you can find plenty of other things on our homepage."}],["$","$L8",null,{"href":"/","className":"focus:shadow-outline-blue inline rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium leading-5 text-white shadow transition-colors duration-150 hover:bg-blue-700 focus:outline-none dark:hover:bg-blue-500","children":"Back to homepage"}]]}]]}],"notFoundStyles":[],"styles":null}]}]]}],["$","footer",null,{"children":["$","div",null,{"className":"mt-16 flex flex-col items-center","children":[["$","div",null,{"className":"mb-3 flex space-x-4","children":[["$","a",null,{"className":"text-sm text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"mailto:yyexela@gmail.com","children":[["$","span",null,{"className":"sr-only","children":"mail"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 20 20","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":[["$","path",null,{"d":"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}],["$","path",null,{"d":"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"}]]}]]}],["$","a",null,{"className":"text-sm text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://github.com/yyexela","children":[["$","span",null,{"className":"sr-only","children":"github"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 24 24","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":["$","path",null,{"d":"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"}]}]]}],null,null,["$","a",null,{"className":"text-sm text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://www.linkedin.com/in/alexeyy","children":[["$","span",null,{"className":"sr-only","children":"linkedin"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 24 24","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":["$","path",null,{"d":"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"}]}]]}],null,null,null]}],["$","div",null,{"className":"mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400","children":[["$","div",null,{"children":"Alexey Yermakov"}],["$","div",null,{"children":" • "}],["$","div",null,{"children":"© 2024"}]]}]]}]}]]}]}]]}]}]]}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/blog/_next/static/css/4413eb05f145b97b.css","precedence":"next","crossOrigin":""}]],"$Lc"]]]]
d:I[144,["250","static/chunks/250-29b8274b9df70a43.js","749","static/chunks/749-e60b3fc40fd6d6ff.js","797","static/chunks/app/blog/%5B...slug%5D/page-85ddb9cf35024602.js"],""]
e:I[1749,["250","static/chunks/250-29b8274b9df70a43.js","749","static/chunks/749-e60b3fc40fd6d6ff.js","797","static/chunks/app/blog/%5B...slug%5D/page-85ddb9cf35024602.js"],"Image"]
f:I[7738,["250","static/chunks/250-29b8274b9df70a43.js","749","static/chunks/749-e60b3fc40fd6d6ff.js","797","static/chunks/app/blog/%5B...slug%5D/page-85ddb9cf35024602.js"],""]
2:[["$","script",null,{"type":"application/ld+json","dangerouslySetInnerHTML":{"__html":"{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"Getting Started with Hyak\",\"datePublished\":\"2024-03-30T00:00:00.000Z\",\"dateModified\":\"2024-03-30T00:00:00.000Z\",\"description\":\"My journey getting started with UW's Hyak supercomputer\",\"image\":\"/static/images/prof_pic.png\",\"url\":\"https://yyexela.github.io//blog/research/using-hyak-guide\",\"author\":[{\"@type\":\"Person\",\"name\":\"Alexey Yermakov\"}]}"}}],["$","section",null,{"className":"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0","children":[["$","$Ld",null,{}],["$","article",null,{"children":["$","div",null,{"className":"xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700","children":[["$","header",null,{"className":"pt-6 xl:pb-6","children":["$","div",null,{"className":"space-y-1 text-center","children":[["$","dl",null,{"className":"space-y-10","children":["$","div",null,{"children":[["$","dt",null,{"className":"sr-only","children":"Published on"}],["$","dd",null,{"className":"text-base font-medium leading-6 text-gray-500 dark:text-gray-400","children":["$","time",null,{"dateTime":"2024-03-30T00:00:00.000Z","children":"Friday, March 29, 2024"}]}]]}]}],["$","div",null,{"children":["$","h1",null,{"className":"text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14","children":"Getting Started with Hyak"}]}]]}]}],["$","div",null,{"className":"grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0","children":[["$","dl",null,{"className":"pb-10 pt-6 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700","children":[["$","dt",null,{"className":"sr-only","children":"Authors"}],["$","dd",null,{"children":["$","ul",null,{"className":"flex flex-wrap justify-center gap-4 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8","children":[["$","li","Alexey Yermakov",{"className":"flex items-center space-x-2","children":[["$","$Le",null,{"src":"/blog//static/images/prof_pic.png","width":38,"height":38,"alt":"avatar","className":"h-10 w-10 rounded-full"}],["$","dl",null,{"className":"whitespace-nowrap text-sm font-medium leading-5","children":[["$","dt",null,{"className":"sr-only","children":"Name"}],["$","dd",null,{"className":"text-gray-900 dark:text-gray-100","children":"Alexey Yermakov"}],["$","dt",null,{"className":"sr-only","children":"Twitter"}],["$","dd",null,{"children":"$undefined"}]]}]]}]]}]}]]}],["$","div",null,{"className":"divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0","children":[["$","div",null,{"className":"prose max-w-none pb-8 pt-10 dark:prose-invert","children":[["$","h1",null,{"id":"hyak-tutorial","children":[["$","a",null,{"href":"#hyak-tutorial","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Hyak Tutorial"]}],["$","p",null,{"children":"In this tutorial I show what I did to get the Hyak supercomputer running with a GPU. This tutorial covers:"}],["$","ul",null,{"children":[["$","li",null,{"children":"Logging into Hyak"}],["$","li",null,{"children":"Commands to view/manage resources"}],["$","li",null,{"children":"Creating an interactive shell with resources"}],["$","li",null,{"children":"What the heck is Apptainer (with special guest Docker)"}],["$","li",null,{"children":"Using a GPU"}],["$","li",null,{"children":"Creating a batch job"}]]}],["$","h2",null,{"id":"index","children":[["$","a",null,{"href":"#index","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Index"]}],["$","ul",null,{"children":[["$","li",null,{"children":["$","a",null,{"href":"#step-1-logging-in","children":"1: Logging In"}]}],["$","li",null,{"children":["$","a",null,{"href":"#step-2-useful-commands","children":"2: Useful Commands"}]}],["$","li",null,{"children":["$","a",null,{"href":"#step-3-getting-your-code","children":"3: Getting Your Code"}]}],["$","li",null,{"children":["$","a",null,{"href":"#step-4-running-an-interactive-session","children":"4: Running an Interactive Session"}]}],["$","li",null,{"children":["$","a",null,{"href":"#step-5-docker-to-apptainer","children":"5: Docker to Apptainer"}]}],["$","li",null,{"children":["$","a",null,{"href":"#step-6-run-apptainer-interactively","children":"6: Run Apptainer Interatively"}]}],["$","li",null,{"children":["$","a",null,{"href":"#step-7-apptainer-runscript","children":"7: Apptainer Runscript"}]}],["$","li",null,{"children":["$","a",null,{"href":"#step-8-batch-script","children":"8: Batch Script"}]}],["$","li",null,{"children":["$","a",null,{"href":"#step-9-treat-yo-self","children":"9: Treat Yo Self"}]}]]}],["$","h2",null,{"id":"useful-links","children":[["$","a",null,{"href":"#useful-links","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Useful links"]}],["$","p",null,{"children":["Below are some useful links I found that can be useful for further/supplemental reading:",["$","br",null,{}],["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://hyak.uw.edu/docs","children":"Hyak Documentation"}],["$","br",null,{}],["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://hyak.uw.edu/docs/compute/checkpoint/","children":"Hyak Idle/Checkpoint Resources"}]]}],["$","ul",null,{"children":["$","li",null,{"children":"Please read this, this is from UW and is very nice for getting started."}]}],["$","p",null,{"children":[["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://slurm.schedmd.com/","children":"Slurm Documentation"}],["$","br",null,{}],["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://slurm.schedmd.com/sbatch.html","children":"Slurm sbatch Environment Variables"}]]}],["$","ul",null,{"children":["$","li",null,{"children":"Slurm is what is used to manage resources on Hyak, this is the main documentation for that."}]}],["$","p",null,{"children":[["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://apptainer.org/docs/user/1.1/","children":"Apptainer 1.1"}],["$","br",null,{}],["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://apptainer.org/docs/user/main/docker_and_oci.html#apptainer-definition-file-vs-dockerfile","children":"Apptainer from Dockerfile"}],["$","br",null,{}],["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://apptainer.org/docs/user/main/definition_files.html","children":"Apptainer definition file"}]]}],["$","ul",null,{"children":["$","li",null,{"children":"Apptainer is the Docker replacement for Hyak. It can be used to create images with arbitrary OS's and packages installed that you might not be able to install directly on Hyak."}]}],["$","h2",null,{"id":"what-i-did","children":[["$","a",null,{"href":"#what-i-did","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"What I did"]}],["$","p",null,{"children":["My goal was to get ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/yyexela/OmniAnomaly/tree/docker","children":"this code"}]," working on Hyak. Essentially, I needed to somehow:"]}],["$","ul",null,{"children":[["$","li",null,{"children":"Allocate resources on Hyak (CPU/GPU/RAM)"}],["$","li",null,{"children":"Access those resources"}],["$","li",null,{"children":"Start up a Docker container from an image"}],["$","li",null,{"children":"Run the code in the Docker container with GPU support"}]]}],["$","p",null,{"children":"I got access through the AMATH department, so you may see some things differently depending on how you get access."}],["$","h4",null,{"id":"step-1-logging-in","children":[["$","a",null,{"href":"#step-1-logging-in","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Step 1: Logging In"]}],["$","p",null,{"children":"You can just SSH into Hyak using your NetID:"}],["$","ul",null,{"children":["$","li",null,{"children":["$","code",null,{"children":"ssh <NETID>@klone.hyak.uw.edu"}]}]}],["$","h4",null,{"id":"step-2-useful-commands","children":[["$","a",null,{"href":"#step-2-useful-commands","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Step 2: Useful Commands"]}],["$","p",null,{"children":"Once logged in, you can do the following to view/manage resources:"}],["$","ul",null,{"children":[["$","li",null,{"children":[["$","code",null,{"children":"hyakalloc"}],": See available resources (you will see two tables: the first are resources available specific to group(s) you're in, the second are unused resources by groups you're not in, but are available to you anyways, called ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://hyak.uw.edu/docs/compute/checkpoint/","children":"checkpoint resources"}],")."]}],["$","li",null,{"children":[["$","code",null,{"children":"hyakstorage"}],": Shows your disk usage."]}],["$","li",null,{"children":[["$","code",null,{"children":"dns"}],": The package manager for Rocky Linux, which Hyak is running. You can do ",["$","code",null,{"children":"dns search <script>"}]," to see which package was installed for a certain command. I used this for figuring out which package installed ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://slurm.schedmd.com/sinfo.html","children":["$","code",null,{"children":"sinfo"}]}],", which shows \"information about Slurm nodes and partitions\"."]}],["$","li",null,{"children":[["$","code",null,{"children":"squeue -u $USER --long"}],": Shows jobs you're running."]}],["$","li",null,{"children":[["$","code",null,{"children":"sinfo"}],": Shows information about Slurm nodes and partitions."]}],["$","li",null,{"children":[["$","code",null,{"children":"sacct"}],": Shows job information (running/stopped/pending/etc..)."]}],["$","li",null,{"children":[["$","code",null,{"children":"sacct --starttime <YYYY-MM-DD> --format=User,JobID,Jobname%50,partition,state,time,start,end,elapsed,MaxRss,MaxVMSize,nnodes,ncpus,nodelist"}],": Shows job history from specified date ",["$","code",null,{"children":"<YYYY-MM-DD>"}]," (",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://stackoverflow.com/questions/48187625/slurm-job-history-get-full-length-jobname","children":"source"}],")."]}],["$","li",null,{"children":[["$","code",null,{"children":"scancel <JOBID>"}],": Cancel a job with ID ",["$","code",null,{"children":"<JOBID>"}],"."]}],["$","li",null,{"children":[["$","code",null,{"children":"scp"}],": Copy files from another computer using SSH."]}],["$","li",null,{"children":[["$","code",null,{"children":"nvidia-smi"}],": Shows graphics card usage (only works when inside an interactive session with a GPU)."]}],["$","li",null,{"children":[["$","code",null,{"children":"ps -lu $USER"}],": Shows niceness of processes you're running."]}],["$","li",null,{"children":[["$","code",null,{"children":"module avail"}],": List available modules (only works in compute node)"]}],["$","li",null,{"children":[["$","code",null,{"children":"module load <module>"}],": Load specified module (only works in compute node)"]}],["$","li",null,{"children":[["$","code",null,{"children":"module list"}],": List loaded modules (only works in compute node)"]}]]}],["$","p",null,{"children":["Note: Most commands have a \"manual\" that you can get access to by running ",["$","code",null,{"children":"man <command>"}]," in the terminal."]}],["$","h4",null,{"id":"step-3-getting-your-code","children":[["$","a",null,{"href":"#step-3-getting-your-code","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Step 3: Getting your code"]}],["$","p",null,{"children":["To copy your code you can just set up git and download it to Hyak. Make sure you download to the login node, as data downloaded there appears to be shared across all compute nodes. I also needed to copy over data from a desktop computer in UW's network, so I set up SSH and used the ",["$","code",null,{"children":"scp"}]," utility to transfer those files over to Hyak."]}],["$","h4",null,{"id":"step-4-running-an-interactive-session","children":[["$","a",null,{"href":"#step-4-running-an-interactive-session","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Step 4: Running an Interactive Session"]}],["$","p",null,{"children":"The next step, and something that's useful in general, is getting access to resources. The easiest way to do this is to start an interactive shell session with resources allocated to it. The command I used was:"}],["$","ul",null,{"children":["$","li",null,{"children":[["$","code",null,{"children":"salloc -A amath -p ckpt -N 1 -n 2 -c 4 -G 1 --mem=4G --time=5:00:00 --nice=0"}],["$","ul",null,{"children":[["$","li",null,{"children":[["$","code",null,{"children":"-A amath"}],": ",["$","code",null,{"children":"amath"}]," group (from running the ",["$","code",null,{"children":"groups"}]," command)."]}],["$","li",null,{"children":[["$","code",null,{"children":"-p ckpt"}],": resource patition being used (from ",["$","code",null,{"children":"sinfo"}],", I have access to ",["$","code",null,{"children":"gpu-rtx6k"}]," from amath or ",["$","code",null,{"children":"ckpt"}],")."]}],["$","li",null,{"children":[["$","code",null,{"children":"-N 1"}],": number of nodes these resources spread across (most of the time it's ",["$","code",null,{"children":"1"}],", unless code supports another case)."]}],["$","li",null,{"children":[["$","code",null,{"children":"-n 2"}],": the maximum number of tasks that is expected to be launched to complete the job."]}],["$","li",null,{"children":[["$","code",null,{"children":"-c 4"}],": number of compute cores needed (CPUs per task)."]}],["$","li",null,{"children":[["$","code",null,{"children":"-G 1"}],": the number of GPUs required for this job."]}],["$","li",null,{"children":[["$","code",null,{"children":"--mem=4G"}],": amount of RAM needed."]}],["$","li",null,{"children":[["$","code",null,{"children":"-t"}],": maximum runtime for the job (",["$","code",null,{"children":"h:m:s"}]," or ",["$","code",null,{"children":"days-hours"}]," or ",["$","code",null,{"children":"minutes"}],")."]}],["$","li",null,{"children":[["$","code",null,{"children":"--nice=<value>"}],": ",["$","code",null,{"children":"<value>"}]," is a number ",["$","code",null,{"children":"-2147483645 <= <value> <= 2147483645"}],", higher nice means the job has a lower priority and can be preempted by a job with a higher priority. Please use higher nice values for jobs that are expected to take longer to run!"]}]]}]]}]}],["$","p",null,{"children":["Once your job has been allocated resources, you can see which GPU you were given with ",["$","code",null,{"children":"nvidia-smi"}],"."]}],["$","h4",null,{"id":"step-5-docker-to-apptainer","children":[["$","a",null,{"href":"#step-5-docker-to-apptainer","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Step 5: Docker to Apptainer"]}],["$","p",null,{"children":["The code originally was run in Docker, but that's not supported since it requires root priveleges. However, Apptainer ",["$","em",null,{"children":"is"}]," supported, so here's what I did to get that working."]}],["$","p",null,{"children":"In the original code, I had a Dockerfile:"}],["$","$Lf",null,{"className":"language-dockerfile","children":["$","code",null,{"className":"code-highlight language-Dockerfile","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"# Base image"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"FROM"}]," tensorflow/tensorflow:1.15.0-gpu"]}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"# Resolves error with key"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"# See: https://developer.nvidia.com/blog/updating-the-cuda-linux-gpg-repository-key/"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"# See: https://askubuntu.com/questions/1444943/nvidia-gpg-error-the-following-signatures-couldnt-be-verified-because-the-publi"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"RUN"}]," apt-key adv --fetch-keys https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64/3bf863cc.pub"]}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"# Update image contents to have latest python3 and pip3 for image"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"RUN"}]," apt-get update"]}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"RUN"}]," apt-get install -y python3-pip python3-dev vim"]}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"WORKDIR"}]," /usr/local/bin"]}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"RUN"}]," rm /usr/local/bin/python"]}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"RUN"}]," ln -s /usr/bin/python3 python"]}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"RUN"}]," pip3 install --upgrade pip"]}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"RUN"}]," apt-get install -y git curl zip unzip"]}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"# Create /app directory"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"WORKDIR"}]," /app"]}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"# Copy OmniAnomaly requirements into image"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"COPY"}]," ./requirements.txt /app"]}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"# Install OmniAnomaly requirements "}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"RUN"}]," pip3 install -r requirements.txt"]}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"# Set initial folder to be OmniAnomaly"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"WORKDIR"}]," /app/OmniAnomaly"]}],"\n"]}]]}]}],["$","p",null,{"children":"which I built with the following command:"}],["$","ul",null,{"children":["$","li",null,{"children":["$","code",null,{"children":"docker build -t omnianomaly ."}]}]}],["$","p",null,{"children":"and ran with:"}],["$","ul",null,{"children":["$","li",null,{"children":["$","code",null,{"children":"docker run --gpus all -u $(id -u):$(id -g) -v./:/app/OmniAnomaly -it --rm omnianomaly bash"}]}]}],["$","p",null,{"children":"What this did was:"}],["$","ul",null,{"children":["$","li",null,{"children":["Create a Docker Image with Tensorflow1.15.0 that supports GPU usage, installs my required packages (",["$","code",null,{"children":"requirements.txt"}],"), and changes the working directory to ",["$","code",null,{"children":"/app/OmniAnomaly"}]," which contains the code from ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/yyexela/OmniAnomaly/tree/docker","children":"here"}],"."]}]}],["$","p",null,{"children":"I could then run the code by running:"}],["$","ul",null,{"children":["$","li",null,{"children":["$","code",null,{"children":"python main.py --dataset='MSL' --max_epoch=20"}]}]}],["$","p",null,{"children":["Note, ",["$","code",null,{"children":"requirements.txt"}]," contains:"]}],["$","$Lf",null,{"className":"language-js","children":["$","code",null,{"className":"language-js code-highlight","children":[["$","span",null,{"className":"code-line","children":["six ",["$","span",null,{"className":"token operator","children":"=="}]," ",["$","span",null,{"className":"token number","children":"1.11"}],["$","span",null,{"className":"token number","children":".0"}],"\n"]}],["$","span",null,{"className":"code-line","children":["matplotlib ",["$","span",null,{"className":"token operator","children":"=="}]," ",["$","span",null,{"className":"token number","children":"3.0"}],["$","span",null,{"className":"token number","children":".2"}],"\n"]}],["$","span",null,{"className":"code-line","children":["numpy ",["$","span",null,{"className":"token operator","children":"=="}]," ",["$","span",null,{"className":"token number","children":"1.16"}],["$","span",null,{"className":"token number","children":".0"}],"\n"]}],["$","span",null,{"className":"code-line","children":["pandas ",["$","span",null,{"className":"token operator","children":"=="}]," ",["$","span",null,{"className":"token number","children":"0.23"}],["$","span",null,{"className":"token number","children":".4"}],"\n"]}],["$","span",null,{"className":"code-line","children":["scipy ",["$","span",null,{"className":"token operator","children":"=="}]," ",["$","span",null,{"className":"token number","children":"1.2"}],["$","span",null,{"className":"token number","children":".0"}],"\n"]}],["$","span",null,{"className":"code-line","children":["scikit_learn ",["$","span",null,{"className":"token operator","children":"=="}]," ",["$","span",null,{"className":"token number","children":"0.20"}],["$","span",null,{"className":"token number","children":".2"}],"\n"]}],["$","span",null,{"className":"code-line","children":["tensorflow",["$","span",null,{"className":"token operator","children":"-"}],"gpu ",["$","span",null,{"className":"token operator","children":"=="}]," ",["$","span",null,{"className":"token number","children":"1.15"}],["$","span",null,{"className":"token number","children":".0"}],"\n"]}],["$","span",null,{"className":"code-line","children":["tensorflow_probability ",["$","span",null,{"className":"token operator","children":"=="}]," ",["$","span",null,{"className":"token number","children":"0.8"}],["$","span",null,{"className":"token number","children":".0"}],"\n"]}],["$","span",null,{"className":"code-line","children":["tqdm ",["$","span",null,{"className":"token operator","children":"=="}]," ",["$","span",null,{"className":"token number","children":"4.28"}],["$","span",null,{"className":"token number","children":".1"}],"\n"]}],["$","span",null,{"className":"code-line","children":["imageio ",["$","span",null,{"className":"token operator","children":"=="}]," ",["$","span",null,{"className":"token number","children":"2.4"}],["$","span",null,{"className":"token number","children":".1"}],"\n"]}],["$","span",null,{"className":"code-line","children":["fs ",["$","span",null,{"className":"token operator","children":"=="}]," ",["$","span",null,{"className":"token number","children":"2.3"}],["$","span",null,{"className":"token number","children":".0"}],"\n"]}],["$","span",null,{"className":"code-line","children":["click ",["$","span",null,{"className":"token operator","children":"=="}]," ",["$","span",null,{"className":"token number","children":"7.0"}],"\n"]}],["$","span",null,{"className":"code-line","children":["git",["$","span",null,{"className":"token operator","children":"+"}],"https",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token operator","children":"/"}],"github",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"com"}],["$","span",null,{"className":"token operator","children":"/"}],"yyexela",["$","span",null,{"className":"token operator","children":"/"}],"tfsnippet",["$","span",null,{"className":"token operator","children":"-"}],"tf",["$","span",null,{"className":"token operator","children":"-"}],"compat",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"git"}],"@v1\n"]}],["$","span",null,{"className":"code-line","children":["git",["$","span",null,{"className":"token operator","children":"+"}],"https",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token operator","children":"/"}],"github",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"com"}],["$","span",null,{"className":"token operator","children":"/"}],"yyexela",["$","span",null,{"className":"token operator","children":"/"}],"zhusuan",["$","span",null,{"className":"token operator","children":"-"}],"tf",["$","span",null,{"className":"token operator","children":"-"}],"compat",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"git"}],"@v1\n"]}]]}]}],["$","p",null,{"children":["To convert the Docker image to an Apptainer container, I created the following ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://apptainer.org/docs/user/main/definition_files.html","children":"definition file"}],":"]}],["$","$Lf",null,{"className":"language-js","children":["$","code",null,{"className":"language-js code-highlight","children":[["$","span",null,{"className":"code-line","children":["# ",["$","span",null,{"className":"token maybe-class-name","children":"Base"}]," image\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token literal-property property","children":"Bootstrap"}],["$","span",null,{"className":"token operator","children":":"}]," docker\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token literal-property property","children":"From"}],["$","span",null,{"className":"token operator","children":":"}]," tensorflow",["$","span",null,{"className":"token operator","children":"/"}],"tensorflow",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"1.15"}],["$","span",null,{"className":"token number","children":".0"}],["$","span",null,{"className":"token operator","children":"-"}],"gpu\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token operator","children":"%"}],"post\n"]}],["$","span",null,{"className":"code-line","children":["        # ",["$","span",null,{"className":"token maybe-class-name","children":"Resolves"}]," error ",["$","span",null,{"className":"token keyword","children":"with"}]," key\n"]}],["$","span",null,{"className":"code-line","children":["        # ",["$","span",null,{"className":"token maybe-class-name","children":"See"}],["$","span",null,{"className":"token operator","children":":"}]," https",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token operator","children":"/"}],"developer",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"nvidia"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"com"}],["$","span",null,{"className":"token operator","children":"/"}],"blog",["$","span",null,{"className":"token operator","children":"/"}],"updating",["$","span",null,{"className":"token operator","children":"-"}],"the",["$","span",null,{"className":"token operator","children":"-"}],"cuda",["$","span",null,{"className":"token operator","children":"-"}],"linux",["$","span",null,{"className":"token operator","children":"-"}],"gpg",["$","span",null,{"className":"token operator","children":"-"}],"repository",["$","span",null,{"className":"token operator","children":"-"}],"key",["$","span",null,{"className":"token operator","children":"/"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        # ",["$","span",null,{"className":"token maybe-class-name","children":"See"}],["$","span",null,{"className":"token operator","children":":"}]," https",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token operator","children":"/"}],"askubuntu",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"com"}],["$","span",null,{"className":"token operator","children":"/"}],"questions",["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token number","children":"1444943"}],["$","span",null,{"className":"token operator","children":"/"}],"nvidia",["$","span",null,{"className":"token operator","children":"-"}],"gpg",["$","span",null,{"className":"token operator","children":"-"}],"error",["$","span",null,{"className":"token operator","children":"-"}],"the",["$","span",null,{"className":"token operator","children":"-"}],"following",["$","span",null,{"className":"token operator","children":"-"}],"signatures",["$","span",null,{"className":"token operator","children":"-"}],"couldnt",["$","span",null,{"className":"token operator","children":"-"}],"be",["$","span",null,{"className":"token operator","children":"-"}],"verified",["$","span",null,{"className":"token operator","children":"-"}],"because",["$","span",null,{"className":"token operator","children":"-"}],"the",["$","span",null,{"className":"token operator","children":"-"}],"publi\n"]}],["$","span",null,{"className":"code-line","children":["        apt",["$","span",null,{"className":"token operator","children":"-"}],"key adv ",["$","span",null,{"className":"token operator","children":"--"}],"fetch",["$","span",null,{"className":"token operator","children":"-"}],"keys https",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token operator","children":"/"}],"developer",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"download"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"nvidia"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"com"}],["$","span",null,{"className":"token operator","children":"/"}],"compute",["$","span",null,{"className":"token operator","children":"/"}],"cuda",["$","span",null,{"className":"token operator","children":"/"}],"repos",["$","span",null,{"className":"token operator","children":"/"}],"ubuntu1804",["$","span",null,{"className":"token operator","children":"/"}],"x86_64",["$","span",null,{"className":"token operator","children":"/"}],"3bf863cc",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"pub"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["        # ",["$","span",null,{"className":"token maybe-class-name","children":"Update"}]," image contents to have latest python3 and pip3 ",["$","span",null,{"className":"token keyword control-flow","children":"for"}]," image\n"]}],["$","span",null,{"className":"code-line","children":["        apt",["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token keyword","children":"get"}]," update\n"]}],["$","span",null,{"className":"code-line","children":["        apt",["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token keyword","children":"get"}]," install ",["$","span",null,{"className":"token operator","children":"-"}],"y python3",["$","span",null,{"className":"token operator","children":"-"}],"pip python3",["$","span",null,{"className":"token operator","children":"-"}],"dev vim\n"]}],["$","span",null,{"className":"code-line","children":["        cd ",["$","span",null,{"className":"token operator","children":"/"}],"usr",["$","span",null,{"className":"token operator","children":"/"}],"local",["$","span",null,{"className":"token operator","children":"/"}],"bin\n"]}],["$","span",null,{"className":"code-line","children":["        rm ",["$","span",null,{"className":"token operator","children":"/"}],"usr",["$","span",null,{"className":"token operator","children":"/"}],"local",["$","span",null,{"className":"token operator","children":"/"}],"bin",["$","span",null,{"className":"token operator","children":"/"}],"python\n"]}],["$","span",null,{"className":"code-line","children":["        ln ",["$","span",null,{"className":"token operator","children":"-"}],"s ",["$","span",null,{"className":"token operator","children":"/"}],"usr",["$","span",null,{"className":"token operator","children":"/"}],"bin",["$","span",null,{"className":"token operator","children":"/"}],"python3 python\n"]}],["$","span",null,{"className":"code-line","children":["        pip3 install ",["$","span",null,{"className":"token operator","children":"--"}],"upgrade pip\n"]}],["$","span",null,{"className":"code-line","children":["        apt",["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token keyword","children":"get"}]," install ",["$","span",null,{"className":"token operator","children":"-"}],"y git curl zip unzip\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["        # ",["$","span",null,{"className":"token maybe-class-name","children":"Install"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"OmniAnomaly"}]," requirements \n"]}],["$","span",null,{"className":"code-line","children":["        pip3 install ",["$","span",null,{"className":"token operator","children":"-"}],"r ",["$","span",null,{"className":"token operator","children":"/"}],"app",["$","span",null,{"className":"token operator","children":"/"}],"requirements",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"txt"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token operator","children":"%"}],"files\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token operator","children":"/"}],"mmfs1",["$","span",null,{"className":"token operator","children":"/"}],"home",["$","span",null,{"className":"token operator","children":"/"}],"alexeyy",["$","span",null,{"className":"token operator","children":"/"}],"storage",["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token maybe-class-name","children":"School"}],["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token maybe-class-name","children":"Research"}],["$","span",null,{"className":"token operator","children":"/"}],"submodules",["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token maybe-class-name","children":"OmniAnomaly"}],["$","span",null,{"className":"token operator","children":"/"}],"requirements",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"txt"}]," ",["$","span",null,{"className":"token operator","children":"/"}],"app",["$","span",null,{"className":"token operator","children":"/"}],"requirements",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"txt"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}]]}]}],["$","p",null,{"children":"I could then build the container with:"}],["$","ul",null,{"children":[["$","li",null,{"children":["$","code",null,{"children":"apptainer build ./omnianomaly.sif ./omnianomaly.def"}]}],["$","li",null,{"children":"Note: Please run this in a compute node, not a login node"}]]}],["$","h4",null,{"id":"step-6-run-apptainer-interactively","children":[["$","a",null,{"href":"#step-6-run-apptainer-interactively","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Step 6: Run Apptainer Interactively"]}],["$","p",null,{"children":"I could then run the Apptainer container with:"}],["$","ul",null,{"children":["$","li",null,{"children":[["$","code",null,{"children":"apptainer shell --nv --bind .:/app/omnianomaly omnianomaly.sif"}],["$","ul",null,{"children":[["$","li",null,{"children":[["$","code",null,{"children":"shell"}],": Start the container interactively."]}],["$","li",null,{"children":[["$","code",null,{"children":"--nv"}],": Allow NVIDIA GPU support (very important!!!)."]}],["$","li",null,{"children":[["$","code",null,{"children":"--bind <src>:<dest>"}],": Mount files/directories from outside the container ",["$","code",null,{"children":"<src>"}]," to inside the container ",["$","code",null,{"children":"<dest>"}],"."]}],["$","li",null,{"children":[["$","code",null,{"children":"omnianomaly.sif"}],": The container I created earlier."]}]]}]]}]}],["$","p",null,{"children":"Once in, I verify I have GPU access by the following sequence of commands:"}],["$","ul",null,{"children":[["$","li",null,{"children":["$","code",null,{"children":"python"}]}],["$","li",null,{"children":["$","code",null,{"children":">> import tensorflow as tf"}]}],["$","li",null,{"children":["$","code",null,{"children":">> sess = tf.Session(config=tf.ConfigProto(log_device_placement=True))"}]}]]}],["$","p",null,{"children":"I have the following in my output, showing I have GPU availability!"}],["$","$Lf",null,{"className":"language-js","children":["$","code",null,{"className":"language-js code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token operator spread","children":"..."}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token number","children":"2024"}],["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token number","children":"03"}],["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token number","children":"29"}]," ",["$","span",null,{"className":"token number","children":"16"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"02"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"52.475353"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token constant","children":"I"}]," tensorflow",["$","span",null,{"className":"token operator","children":"/"}],"core",["$","span",null,{"className":"token operator","children":"/"}],"common_runtime",["$","span",null,{"className":"token operator","children":"/"}],"gpu",["$","span",null,{"className":"token operator","children":"/"}],"gpu_device",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"cc"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"1746"}],["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"Adding"}]," visible gpu devices",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token number","children":"0"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token operator spread","children":"..."}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token number","children":"2024"}],["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token number","children":"03"}],["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token number","children":"29"}]," ",["$","span",null,{"className":"token number","children":"16"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"02"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"52.481848"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token constant","children":"I"}]," tensorflow",["$","span",null,{"className":"token operator","children":"/"}],"core",["$","span",null,{"className":"token operator","children":"/"}],"common_runtime",["$","span",null,{"className":"token operator","children":"/"}],"gpu",["$","span",null,{"className":"token operator","children":"/"}],"gpu_device",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"cc"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"1304"}],["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"Created"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"TensorFlow"}]," ",["$","span",null,{"className":"token function","children":"device"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token operator","children":"/"}],"job",["$","span",null,{"className":"token operator","children":":"}],"localhost",["$","span",null,{"className":"token operator","children":"/"}],"replica",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token operator","children":"/"}],"task",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token operator","children":"/"}],"device",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token constant","children":"GPU"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"0"}]," ",["$","span",null,{"className":"token keyword","children":"with"}]," ",["$","span",null,{"className":"token number","children":"10311"}]," ",["$","span",null,{"className":"token constant","children":"MB"}]," memory",["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token operator","children":">"}]," physical ",["$","span",null,{"className":"token constant","children":"GPU"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],"device",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token literal-property property","children":"name"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token constant","children":"NVIDIA"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"GeForce"}]," ",["$","span",null,{"className":"token constant","children":"RTX"}]," ",["$","span",null,{"className":"token number","children":"2080"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"Ti"}],["$","span",null,{"className":"token punctuation","children":","}]," pci bus id",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token number","children":"0000"}],["$","span",null,{"className":"token operator","children":":"}],"b1",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"00.0"}],["$","span",null,{"className":"token punctuation","children":","}]," compute capability",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token number","children":"7.5"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token operator spread","children":"..."}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token operator","children":"/"}],"job",["$","span",null,{"className":"token operator","children":":"}],"localhost",["$","span",null,{"className":"token operator","children":"/"}],"replica",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token operator","children":"/"}],"task",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token operator","children":"/"}],"device",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token constant","children":"GPU"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"0"}]," ",["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token operator","children":">"}]," device",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token literal-property property","children":"name"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token constant","children":"NVIDIA"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"GeForce"}]," ",["$","span",null,{"className":"token constant","children":"RTX"}]," ",["$","span",null,{"className":"token number","children":"2080"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"Ti"}],["$","span",null,{"className":"token punctuation","children":","}]," pci bus id",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token number","children":"0000"}],["$","span",null,{"className":"token operator","children":":"}],"b1",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"00.0"}],["$","span",null,{"className":"token punctuation","children":","}]," compute capability",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token number","children":"7.5"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token operator spread","children":"..."}],"\n"]}]]}]}],["$","p",null,{"children":["Success! Now, how to run this as a batch job (ie. ",["$","em",null,{"children":"not"}]," interactively)."]}],["$","h4",null,{"id":"step-7-apptainer-runscript","children":[["$","a",null,{"href":"#step-7-apptainer-runscript","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Step 7: Apptainer Runscript"]}],["$","p",null,{"children":["The next step is to be able to run our Apptainer container from the command line before making a batch script. To do this, you add a ",["$","code",null,{"children":"%runscript"}]," section to your definition file. My updated file looks like this:"]}],["$","$Lf",null,{"className":"language-js","children":["$","code",null,{"className":"language-js code-highlight","children":[["$","span",null,{"className":"code-line","children":["# ",["$","span",null,{"className":"token maybe-class-name","children":"Base"}]," image\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token literal-property property","children":"Bootstrap"}],["$","span",null,{"className":"token operator","children":":"}]," docker\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token literal-property property","children":"From"}],["$","span",null,{"className":"token operator","children":":"}]," tensorflow",["$","span",null,{"className":"token operator","children":"/"}],"tensorflow",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"1.15"}],["$","span",null,{"className":"token number","children":".0"}],["$","span",null,{"className":"token operator","children":"-"}],"gpu\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token operator","children":"%"}],"post\n"]}],["$","span",null,{"className":"code-line","children":["        # ",["$","span",null,{"className":"token maybe-class-name","children":"Resolves"}]," error ",["$","span",null,{"className":"token keyword","children":"with"}]," key\n"]}],["$","span",null,{"className":"code-line","children":["        # ",["$","span",null,{"className":"token maybe-class-name","children":"See"}],["$","span",null,{"className":"token operator","children":":"}]," https",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token operator","children":"/"}],"developer",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"nvidia"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"com"}],["$","span",null,{"className":"token operator","children":"/"}],"blog",["$","span",null,{"className":"token operator","children":"/"}],"updating",["$","span",null,{"className":"token operator","children":"-"}],"the",["$","span",null,{"className":"token operator","children":"-"}],"cuda",["$","span",null,{"className":"token operator","children":"-"}],"linux",["$","span",null,{"className":"token operator","children":"-"}],"gpg",["$","span",null,{"className":"token operator","children":"-"}],"repository",["$","span",null,{"className":"token operator","children":"-"}],"key",["$","span",null,{"className":"token operator","children":"/"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        # ",["$","span",null,{"className":"token maybe-class-name","children":"See"}],["$","span",null,{"className":"token operator","children":":"}]," https",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token operator","children":"/"}],"askubuntu",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"com"}],["$","span",null,{"className":"token operator","children":"/"}],"questions",["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token number","children":"1444943"}],["$","span",null,{"className":"token operator","children":"/"}],"nvidia",["$","span",null,{"className":"token operator","children":"-"}],"gpg",["$","span",null,{"className":"token operator","children":"-"}],"error",["$","span",null,{"className":"token operator","children":"-"}],"the",["$","span",null,{"className":"token operator","children":"-"}],"following",["$","span",null,{"className":"token operator","children":"-"}],"signatures",["$","span",null,{"className":"token operator","children":"-"}],"couldnt",["$","span",null,{"className":"token operator","children":"-"}],"be",["$","span",null,{"className":"token operator","children":"-"}],"verified",["$","span",null,{"className":"token operator","children":"-"}],"because",["$","span",null,{"className":"token operator","children":"-"}],"the",["$","span",null,{"className":"token operator","children":"-"}],"publi\n"]}],["$","span",null,{"className":"code-line","children":["        apt",["$","span",null,{"className":"token operator","children":"-"}],"key adv ",["$","span",null,{"className":"token operator","children":"--"}],"fetch",["$","span",null,{"className":"token operator","children":"-"}],"keys https",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token operator","children":"/"}],"developer",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"download"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"nvidia"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"com"}],["$","span",null,{"className":"token operator","children":"/"}],"compute",["$","span",null,{"className":"token operator","children":"/"}],"cuda",["$","span",null,{"className":"token operator","children":"/"}],"repos",["$","span",null,{"className":"token operator","children":"/"}],"ubuntu1804",["$","span",null,{"className":"token operator","children":"/"}],"x86_64",["$","span",null,{"className":"token operator","children":"/"}],"3bf863cc",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"pub"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["        # ",["$","span",null,{"className":"token maybe-class-name","children":"Update"}]," image contents to have latest python3 and pip3 ",["$","span",null,{"className":"token keyword control-flow","children":"for"}]," image\n"]}],["$","span",null,{"className":"code-line","children":["        apt",["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token keyword","children":"get"}]," update\n"]}],["$","span",null,{"className":"code-line","children":["        apt",["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token keyword","children":"get"}]," install ",["$","span",null,{"className":"token operator","children":"-"}],"y python3",["$","span",null,{"className":"token operator","children":"-"}],"pip python3",["$","span",null,{"className":"token operator","children":"-"}],"dev vim\n"]}],["$","span",null,{"className":"code-line","children":["        cd ",["$","span",null,{"className":"token operator","children":"/"}],"usr",["$","span",null,{"className":"token operator","children":"/"}],"local",["$","span",null,{"className":"token operator","children":"/"}],"bin\n"]}],["$","span",null,{"className":"code-line","children":["        rm ",["$","span",null,{"className":"token operator","children":"/"}],"usr",["$","span",null,{"className":"token operator","children":"/"}],"local",["$","span",null,{"className":"token operator","children":"/"}],"bin",["$","span",null,{"className":"token operator","children":"/"}],"python\n"]}],["$","span",null,{"className":"code-line","children":["        ln ",["$","span",null,{"className":"token operator","children":"-"}],"s ",["$","span",null,{"className":"token operator","children":"/"}],"usr",["$","span",null,{"className":"token operator","children":"/"}],"bin",["$","span",null,{"className":"token operator","children":"/"}],"python3 python\n"]}],["$","span",null,{"className":"code-line","children":["        pip3 install ",["$","span",null,{"className":"token operator","children":"--"}],"upgrade pip\n"]}],["$","span",null,{"className":"code-line","children":["        apt",["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token keyword","children":"get"}]," install ",["$","span",null,{"className":"token operator","children":"-"}],"y git curl zip unzip\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["        # ",["$","span",null,{"className":"token maybe-class-name","children":"Install"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"OmniAnomaly"}]," requirements \n"]}],["$","span",null,{"className":"code-line","children":["        pip3 install ",["$","span",null,{"className":"token operator","children":"-"}],"r ",["$","span",null,{"className":"token operator","children":"/"}],"app",["$","span",null,{"className":"token operator","children":"/"}],"requirements",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"txt"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token operator","children":"%"}],"files\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token operator","children":"/"}],"mmfs1",["$","span",null,{"className":"token operator","children":"/"}],"home",["$","span",null,{"className":"token operator","children":"/"}],"alexeyy",["$","span",null,{"className":"token operator","children":"/"}],"storage",["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token maybe-class-name","children":"School"}],["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token maybe-class-name","children":"Research"}],["$","span",null,{"className":"token operator","children":"/"}],"submodules",["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token maybe-class-name","children":"OmniAnomaly"}],["$","span",null,{"className":"token operator","children":"/"}],"requirements",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"txt"}]," ",["$","span",null,{"className":"token operator","children":"/"}],"app",["$","span",null,{"className":"token operator","children":"/"}],"requirements",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"txt"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token operator","children":"%"}],"runscript\n"]}],["$","span",null,{"className":"code-line","children":["        #",["$","span",null,{"className":"token operator","children":"!"}],["$","span",null,{"className":"token operator","children":"/"}],"bin",["$","span",null,{"className":"token operator","children":"/"}],"bash\n"]}],["$","span",null,{"className":"code-line","children":["        echo ",["$","span",null,{"className":"token string","children":"\"Running OmniAnomaly: \\\"time python main.py $*\\\"\""}],"\n"]}],["$","span",null,{"className":"code-line","children":["        cd ",["$","span",null,{"className":"token operator","children":"/"}],"app",["$","span",null,{"className":"token operator","children":"/"}],"omnianomaly ",["$","span",null,{"className":"token operator","children":"&&"}]," time python ",["$","span",null,{"className":"token operator","children":"-"}],"u main",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"py"}]," $@\n"]}],["$","span",null,{"className":"code-line","children":["        exec echo ",["$","span",null,{"className":"token string","children":"\"Finished Running OmniAnomaly\""}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}]]}]}],["$","p",null,{"children":"Then, I can run it on the command line with:"}],["$","ul",null,{"children":["$","li",null,{"children":["$","code",null,{"children":"apptainer run --nv --bind .:/app/omnianomaly omnianomaly.sif --dataset='MSL' --max_epoch=20"}]}]}],["$","h4",null,{"id":"step-8-batch-script","children":[["$","a",null,{"href":"#step-8-batch-script","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Step 8: Batch Script"]}],["$","p",null,{"children":["The last step to get everything working is to create a batch script that is automatically run when a batch job is created. I created a file called ",["$","code",null,{"children":"omnianomaly.slurm"}]," with the following contents:"]}],["$","$Lf",null,{"children":["$","code",null,{"className":"code-highlight language-slurm","children":[["$","span",null,{"className":"code-line","children":"#!/bin/bash\n"}],["$","span",null,{"className":"code-line","children":"  \n"}],["$","span",null,{"className":"code-line","children":"#SBATCH --account=amath\n"}],["$","span",null,{"className":"code-line","children":"#SBATCH --partition=gpu-rtx6k\n"}],["$","span",null,{"className":"code-line","children":"#SBATCH --nodes=1\n"}],["$","span",null,{"className":"code-line","children":"#SBATCH --ntasks=1\n"}],["$","span",null,{"className":"code-line","children":"#SBATCH --gpus=1\n"}],["$","span",null,{"className":"code-line","children":"#SBATCH --mem=16G\n"}],["$","span",null,{"className":"code-line","children":"#SBATCH --cpus-per-task=1\n"}],["$","span",null,{"className":"code-line","children":"#SBATCH --time=00:10:00\n"}],["$","span",null,{"className":"code-line","children":"#SBATCH --nice=0\n"}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":"#SBATCH --job-name=train_MSL\n"}],["$","span",null,{"className":"code-line","children":"#SBATCH --output=/mmfs1/home/alexeyy/storage/logs/output.out\n"}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":"#SBATCH --mail-type=ALL\n"}],["$","span",null,{"className":"code-line","children":"#SBATCH --mail-user=alexeyy@uw.edu\n"}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":"apptainer run --nv --bind /mmfs1/home/alexeyy/storage/School/Research/submodules/OmniAnomaly:/app/omnianomaly /mmfs1/home/alexeyy/storage/School/Research/submodules/OmniAnomaly/omnianomaly.sif --dataset='MSL' --max_epoch=20\n"}]]}]}],["$","p",null,{"children":"I can then request resources for the code to run with"}],["$","ul",null,{"children":["$","li",null,{"children":["$","code",null,{"children":"sbatch omnianomaly.slurm"}]}]}],["$","p",null,{"children":["Note, the SBATCH variables can be seen in detail ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://slurm.schedmd.com/sbatch.html","children":"here"}],":"]}],["$","ul",null,{"children":[["$","li",null,{"children":[["$","code",null,{"children":"--account=amath"}],": Group you're a part of (from ",["$","code",null,{"children":"groups"}],")."]}],["$","li",null,{"children":[["$","code",null,{"children":"--partition=gpu-rtx6k"}],": Partition you have access to (from ",["$","code",null,{"children":"sinfo"}],", can also be ",["$","code",null,{"children":"ckpt"}],")"]}],["$","li",null,{"children":[["$","code",null,{"children":"--nodes=1"}],": number of nodes these resources spread across (most of the time it's ",["$","code",null,{"children":"1"}],", unless code supports another case)."]}],["$","li",null,{"children":[["$","code",null,{"children":"--ntasks=1"}],": The maximum number of tasks that is expected to be launched to complete the job."]}],["$","li",null,{"children":[["$","code",null,{"children":"--gpus=1"}],": The number of GPUs required for this job."]}],["$","li",null,{"children":[["$","code",null,{"children":"--mem=16G"}],": The amount of RAM neede dfor this job."]}],["$","li",null,{"children":[["$","code",null,{"children":"--cpus-per-task=1"}],": Number of compute cores needed per task."]}],["$","li",null,{"children":[["$","code",null,{"children":"--time=00:10:00"}],": Maximum runtime for the job."]}],["$","li",null,{"children":[["$","code",null,{"children":"--nice=100"}],": A number ",["$","code",null,{"children":"-2147483645 <= <value> <= 2147483645"}],", higher nice means the job has a lower priority and can be preempted by a job with a higher priority. Please use higher nice values for jobs that are expected to take longer to run!"]}],["$","li",null,{"children":[["$","code",null,{"children":"--job-name=train_MSL"}],": Add a name for your job."]}],["$","li",null,{"children":[["$","code",null,{"children":"--output=/mmfs1/home/alexeyy/storage/logs/output.out"}],": Output file (where stdout and stderr are redirected to)."]}],["$","li",null,{"children":[["$","code",null,{"children":"--mail-user=alexeyy@uw.edu"}],": Email address to send status updates to."]}],["$","li",null,{"children":[["$","code",null,{"children":"--mail-type=ALL"}],": What kind of updates to send (I wanted everything because it's cool)."]}]]}],["$","h4",null,{"id":"step-9-treat-yo-self","children":[["$","a",null,{"href":"#step-9-treat-yo-self","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Step 9: Treat yo self"]}],["$","p",null,{"children":["I went and got myself banh mi as a well deserved treat! Got everything working by 6pm on a friday",["$","code",null,{"children":":)"}]]}]]}],["$","div",null,{"className":"pb-6 pt-6 text-sm text-gray-700 dark:text-gray-300","children":"Thanks for reading!"}],"$undefined"]}],["$","footer",null,{"children":[["$","div",null,{"className":"divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y","children":[["$","div",null,{"className":"py-4 xl:py-8","children":[["$","h2",null,{"className":"text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400","children":"Tags"}],["$","div",null,{"className":"flex flex-wrap","children":[["$","$L8",null,{"href":"/tags/research","className":"mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":"Research"}],["$","$L8",null,{"href":"/tags/supercomputing","className":"mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":"Supercomputing"}]]}]]}],["$","div",null,{"className":"flex justify-between py-4 xl:block xl:space-y-8 xl:py-8","children":["$undefined",["$","div",null,{"children":[["$","h2",null,{"className":"text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400","children":"Next Article"}],["$","div",null,{"className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":["$","$L8",null,{"href":"/blog/restaurants/midnite-ramen","children":"Midnite Ramen"}]}]]}]]}]]}],["$","div",null,{"className":"pt-4 xl:pt-8","children":["$","$L8",null,{"href":"/blog","className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","aria-label":"Back to the blog","children":"← Back to the blog"}]}]]}]]}]]}]}]]}]]
c:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Getting Started with Hyak | Alexey's Blog"}],["$","meta","3",{"name":"description","content":"My journey getting started with UW's Hyak supercomputer"}],["$","meta","4",{"name":"robots","content":"index, follow"}],["$","meta","5",{"name":"googlebot","content":"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"}],["$","link","6",{"rel":"canonical","href":"https://yyexela.github.io/blog/research/using-hyak-guide"}],["$","link","7",{"rel":"alternate","type":"application/rss+xml","href":"https://yyexela.github.io//feed.xml"}],["$","meta","8",{"property":"og:title","content":"Getting Started with Hyak"}],["$","meta","9",{"property":"og:description","content":"My journey getting started with UW's Hyak supercomputer"}],["$","meta","10",{"property":"og:url","content":"https://yyexela.github.io/blog/research/using-hyak-guide"}],["$","meta","11",{"property":"og:site_name","content":"Alexey's Blog"}],["$","meta","12",{"property":"og:locale","content":"en_US"}],["$","meta","13",{"property":"og:image","content":"https://yyexela.github.io//static/images/prof_pic.png"}],["$","meta","14",{"property":"og:type","content":"article"}],["$","meta","15",{"property":"article:published_time","content":"2024-03-30T00:00:00.000Z"}],["$","meta","16",{"property":"article:modified_time","content":"2024-03-30T00:00:00.000Z"}],["$","meta","17",{"property":"article:author","content":"Alexey Yermakov"}],["$","meta","18",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","19",{"name":"twitter:title","content":"Getting Started with Hyak"}],["$","meta","20",{"name":"twitter:description","content":"My journey getting started with UW's Hyak supercomputer"}],["$","meta","21",{"name":"twitter:image","content":"https://yyexela.github.io/static/images/prof_pic.png"}],["$","meta","22",{"name":"next-size-adjust"}]]
1:null
